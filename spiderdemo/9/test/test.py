import json
import base64
import os
import re
from io import BytesIO
from PIL import Image
import ddddocr
# data={
#     "success": True,
#     "challenge_type": "font_sprites_challenge",
#     "page_data": [
#         "<div class='sprite class3493'></div><div class='sprite class2021'></div><div class='sprite class9853'></div><div class='sprite class3493'></div>",
#         "<div class='sprite class5035'></div><div class='sprite class9853'></div><div class='sprite class5035'></div><div class='sprite class4764'></div>",
#         "<div class='sprite class560'></div><div class='sprite class6653'></div><div class='sprite class421'></div><div class='sprite class3493'></div>",
#         "<div class='sprite class421'></div><div class='sprite class4764'></div><div class='sprite class2021'></div><div class='sprite class5062'></div>",
#         "<div class='sprite class560'></div><div class='sprite class9853'></div><div class='sprite class4764'></div><div class='sprite class5062'></div>",
#         "<div class='sprite class6653'></div><div class='sprite class9853'></div><div class='sprite class5062'></div><div class='sprite class2021'></div>",
#         "<div class='sprite class421'></div><div class='sprite class2021'></div><div class='sprite class421'></div><div class='sprite class5062'></div>",
#         "<div class='sprite class1906'></div><div class='sprite class1906'></div><div class='sprite class3493'></div><div class='sprite class5035'></div>",
#         "<div class='sprite class421'></div><div class='sprite class3493'></div><div class='sprite class421'></div><div class='sprite class560'></div>",
#         "<div class='sprite class6653'></div><div class='sprite class3493'></div><div class='sprite class560'></div><div class='sprite class5062'></div>"
#     ],
#     "current_page": 2,
#     "total_pages": 100,
#     "sprite": "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",
#     "css_code": "<style>.class3493{background-position: -158px 0;}\n.class2021{background-position: -58px 0;}\n.class9853{background-position: -308px 0;}\n.class3493{background-position: -158px 0;}\n.class5035{background-position: -108px 0;}\n.class9853{background-position: -308px 0;}\n.class5035{background-position: -108px 0;}\n.class4764{background-position: -458px 0;}\n.class560{background-position: -258px 0;}\n.class6653{background-position: -358px 0;}\n.class421{background-position: -408px 0;}\n.class3493{background-position: -158px 0;}\n.class421{background-position: -408px 0;}\n.class4764{background-position: -458px 0;}\n.class2021{background-position: -58px 0;}\n.class5062{background-position: -208px 0;}\n.class560{background-position: -258px 0;}\n.class9853{background-position: -308px 0;}\n.class4764{background-position: -458px 0;}\n.class5062{background-position: -208px 0;}\n.class6653{background-position: -358px 0;}\n.class9853{background-position: -308px 0;}\n.class5062{background-position: -208px 0;}\n.class2021{background-position: -58px 0;}\n.class421{background-position: -408px 0;}\n.class2021{background-position: -58px 0;}\n.class421{background-position: -408px 0;}\n.class5062{background-position: -208px 0;}\n.class1906{background-position: -8px 0;}\n.class1906{background-position: -8px 0;}\n.class3493{background-position: -158px 0;}\n.class5035{background-position: -108px 0;}\n.class421{background-position: -408px 0;}\n.class3493{background-position: -158px 0;}\n.class421{background-position: -408px 0;}\n.class560{background-position: -258px 0;}\n.class6653{background-position: -358px 0;}\n.class3493{background-position: -158px 0;}\n.class560{background-position: -258px 0;}\n.class5062{background-position: -208px 0;}\n</style>",
#     "message": "成功获取第2页数据 (font_sprites_challenge) - 已应用CSS精灵图反爬技术"
# }
data={
    "success": True,
    "challenge_type": "font_sprites_challenge",
    "page_data": [
        "<div class='sprite class6451'></div><div class='sprite class9791'></div><div class='sprite class2362'></div><div class='sprite class4471'></div>",
        "<div class='sprite class3025'></div><div class='sprite class4471'></div><div class='sprite class104'></div><div class='sprite class4471'></div>",
        "<div class='sprite class104'></div><div class='sprite class4471'></div><div class='sprite class104'></div><div class='sprite class4471'></div>",
        "<div class='sprite class3025'></div><div class='sprite class9791'></div><div class='sprite class9499'></div><div class='sprite class6467'></div>",
        "<div class='sprite class6467'></div><div class='sprite class3025'></div><div class='sprite class3025'></div><div class='sprite class3374'></div>",
        "<div class='sprite class9791'></div><div class='sprite class6467'></div><div class='sprite class4471'></div><div class='sprite class2362'></div>",
        "<div class='sprite class3025'></div><div class='sprite class9499'></div><div class='sprite class104'></div><div class='sprite class4471'></div>",
        "<div class='sprite class4471'></div><div class='sprite class9499'></div><div class='sprite class104'></div><div class='sprite class3374'></div>",
        "<div class='sprite class3374'></div><div class='sprite class104'></div><div class='sprite class6451'></div><div class='sprite class6451'></div>",
        "<div class='sprite class6451'></div><div class='sprite class9791'></div><div class='sprite class104'></div><div class='sprite class4471'></div>"
    ],
    "current_page": 3,
    "total_pages": 100,
    "sprite": "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",
    "css_code": "<style>.class6451{background-position: -458px 0;}\n.class9791{background-position: -208px 0;}\n.class2362{background-position: -108px 0;}\n.class4471{background-position: -158px 0;}\n.class3025{background-position: -258px 0;}\n.class4471{background-position: -158px 0;}\n.class104{background-position: -308px 0;}\n.class4471{background-position: -158px 0;}\n.class104{background-position: -308px 0;}\n.class4471{background-position: -158px 0;}\n.class104{background-position: -308px 0;}\n.class4471{background-position: -158px 0;}\n.class3025{background-position: -258px 0;}\n.class9791{background-position: -208px 0;}\n.class9499{background-position: -358px 0;}\n.class6467{background-position: -58px 0;}\n.class6467{background-position: -58px 0;}\n.class3025{background-position: -258px 0;}\n.class3025{background-position: -258px 0;}\n.class3374{background-position: -8px 0;}\n.class9791{background-position: -208px 0;}\n.class6467{background-position: -58px 0;}\n.class4471{background-position: -158px 0;}\n.class2362{background-position: -108px 0;}\n.class3025{background-position: -258px 0;}\n.class9499{background-position: -358px 0;}\n.class104{background-position: -308px 0;}\n.class4471{background-position: -158px 0;}\n.class4471{background-position: -158px 0;}\n.class9499{background-position: -358px 0;}\n.class104{background-position: -308px 0;}\n.class3374{background-position: -8px 0;}\n.class3374{background-position: -8px 0;}\n.class104{background-position: -308px 0;}\n.class6451{background-position: -458px 0;}\n.class6451{background-position: -458px 0;}\n.class6451{background-position: -458px 0;}\n.class9791{background-position: -208px 0;}\n.class104{background-position: -308px 0;}\n.class4471{background-position: -158px 0;}\n</style>",
    "message": "成功获取第3页数据 (font_sprites_challenge) - 已应用CSS精灵图反爬技术"
}
# ================== 提取 class 对应偏移 ==================
css_text = data["css_code"]
pattern = re.compile(r"\.(class\d+)\{background-position:\s*(-?\d+)px\s+0;")
class_to_x = {m[0]: int(m[1]) for m in pattern.findall(css_text)}

# ================== 解析 page_data ==================
page_data = data["page_data"]
pages_class = []
for row in page_data:
    classes = re.findall(r"class\d+", row)
    pages_class.append(classes)

# ================== 解码雪碧图 ==================
sprite_img = Image.open(BytesIO(base64.b64decode(data["sprite"])))
sprite_width, sprite_height = sprite_img.size

# 计算每个小字符的宽度
widths = sorted(set(class_to_x.values()))
char_width = min([abs(j-i) for i, j in zip(widths, widths[1:])])
char_height = sprite_height

# ================== OCR ==================
ocr = ddddocr.DdddOcr(det=False, ocr=True)
class_to_char = {}
for cls, x in class_to_x.items():
    x = -x  # 注意这里取负
    crop = sprite_img.crop((x, 0, x + 50, sprite_height))  # 假设每个字符宽50
    crop = crop.convert("L").point(lambda p: 0 if p < 128 else 255)
    res = ocr.classification(crop)
    print(cls, res)  # 打印看看识别结果
    class_to_char[cls] = res

# ================== 拼接结果 ==================
result = []
for row in pages_class:
    row_chars = [class_to_char[cls] for cls in row]
    result.append("".join(row_chars))

# 打印结果
for r in result:
    print(r)